<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Performers</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div><a href="/">Directed by Women</a></div>
  <h1>All Performers</h1>

  <!-- Actors Table -->
  <table>
    <thead>
      <tr>
        <!-- Updated sorting logic with all filters in each header link -->
        <th><a href="?sortField=name&sortOrder=<%= sortField === 'name' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Name</a></th>
        <th><a href="?sortField=id&sortOrder=<%= sortField === 'id' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">ID</a></th>
        <th>
          Gender<br/>
          <!-- Gender Filter Dropdown in Header -->
          <form method="GET" action="/all" style="display: inline-block;">
            <select id="gender-filter" name="gender" onchange="this.form.submit()">
              <option value="0" <%= genderFilter === '0' ? 'selected' : '' %>>All</option>
              <option value="1" <%= genderFilter === '1' ? 'selected' : '' %>>Female</option>
              <option value="2" <%= genderFilter === '2' ? 'selected' : '' %>>Male</option>
              <option value="3" <%= genderFilter === '3' ? 'selected' : '' %>>Non-Binary</option>
            </select>
            <input type="hidden" name="page" value="<%= currentPage %>">
            <input type="hidden" name="sortField" value="<%= sortField %>">
            <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
            <input type="hidden" name="revenue" value="<%= revenueFilter %>">
            <input type="hidden" name="popularity" value="<%= popularityFilter %>">
            <input type="hidden" name="moviesTotal" value="<%= moviesTotalFilter %>">
            <input type="hidden" name="top5billing" value="<%= top5billingFilter %>">
            <input type="hidden" name="topLanguage" value="<%= topLanguageFilter %>">
          </form>
        </th>

        <th>
        <a href="?sortField=topLanguage&sortOrder=<%= sortField === 'topLanguage' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>">Top Language</a><br />
        <!-- Top Language Filter Dropdown in Header -->
        <form method="GET" action="/all" style="display: inline-block;">
          <select id="topLanguage-filter" name="topLanguage" onchange="this.form.submit()">
            <option value="all" <%= topLanguageFilter === 'all' ? 'selected' : '' %>>All</option>
            <% allLanguages.forEach(language => { %>
              <option value="<%= language %>" <%= topLanguageFilter === language ? 'selected' : '' %>>
                <%= language %>
              </option>
            <% }); %>
          </select>
          <input type="hidden" name="page" value="<%= currentPage %>">
          <input type="hidden" name="sortField" value="<%= sortField %>">
          <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
          <input type="hidden" name="gender" value="<%= genderFilter %>">
          <input type="hidden" name="revenue" value="<%= revenueFilter %>">
          <input type="hidden" name="popularity" value="<%= popularityFilter %>">
          <input type="hidden" name="moviesTotal" value="<%= moviesTotalFilter %>">
          <input type="hidden" name="top5billing" value="<%= top5billingFilter %>">
        </form>
      </th>

        <th><a href="?sortField=popularity&sortOrder=<%= sortField === 'popularity' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">TMDB Popularity</a><br/>
          <!-- Popularity Filter Dropdown -->
          <form method="GET" action="/all" style="display: inline-block;">
            <select id="popularity-filter" name="popularity" onchange="this.form.submit()">
              <option value="all" <%= popularityFilter === 'all' ? 'selected' : '' %>>All</option>
              <option value="10" <%= popularityFilter === '10' ? 'selected' : '' %>>Above 10</option>
              <option value="25" <%= popularityFilter === '25' ? 'selected' : '' %>>Above 25</option>
              <option value="50" <%= popularityFilter === '50' ? 'selected' : '' %>>Above 50</option>
              <option value="100" <%= popularityFilter === '100' ? 'selected' : '' %>>Above 100</option>
            </select>
            <input type="hidden" name="page" value="<%= currentPage %>">
            <input type="hidden" name="sortField" value="<%= sortField %>">
            <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
            <input type="hidden" name="gender" value="<%= genderFilter %>">
            <input type="hidden" name="revenue" value="<%= revenueFilter %>">
            <input type="hidden" name="moviesTotal" value="<%= moviesTotalFilter %>">
            <input type="hidden" name="top5billing" value="<%= top5billingFilter %>">
            <input type="hidden" name="topLanguage" value="<%= topLanguageFilter %>">
          </form>
        </th>

        <th><a href="?sortField=revenue&sortOrder=<%= sortField === 'revenue' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Revenue all movies</a><br/>
          <!-- Revenue Filter Dropdown -->
          <form method="GET" action="/all" style="display: inline-block;">
            <select id="revenue-filter" name="revenue" onchange="this.form.submit()">
              <option value="all" <%= revenueFilter === 'all' ? 'selected' : '' %>>All</option>
              <option value="1000000" <%= revenueFilter === '1000000' ? 'selected' : '' %>>Above 1 Million</option>
              <option value="100000000" <%= revenueFilter === '100000000' ? 'selected' : '' %>>Above 100 Million</option>
              <option value="500000000" <%= revenueFilter === '500000000' ? 'selected' : '' %>>Above 500 Million</option>
              <option value="1000000000" <%= revenueFilter === '1000000000' ? 'selected' : '' %>>Above 1 Billion</option>
              <option value="5000000000" <%= revenueFilter === '5000000000' ? 'selected' : '' %>>Above 5 Billion</option>
            </select>
            <input type="hidden" name="page" value="<%= currentPage %>">
            <input type="hidden" name="sortField" value="<%= sortField %>">
            <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
            <input type="hidden" name="gender" value="<%= genderFilter %>">
            <input type="hidden" name="popularity" value="<%= popularityFilter %>">
            <input type="hidden" name="moviesTotal" value="<%= moviesTotalFilter %>">
            <input type="hidden" name="top5billing" value="<%= top5billingFilter %>">
            <input type="hidden" name="topLanguage" value="<%= topLanguageFilter %>">
          </form>
        </th>

        <th><a href="?sortField=movies_total&sortOrder=<%= sortField === 'movies_total' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Movie credits</a><br/>
          <!-- Total Movies Filter Dropdown -->
          <form method="GET" action="/all" style="display: inline-block;">
            <select id="movies-total-filter" name="moviesTotal" onchange="this.form.submit()">
              <option value="all" <%= moviesTotalFilter === 'all' ? 'selected' : '' %>>All</option>
              <option value="10" <%= moviesTotalFilter === '10' ? 'selected' : '' %>>At least 10</option>
              <option value="25" <%= moviesTotalFilter === '25' ? 'selected' : '' %>>At least 25</option>
              <option value="50" <%= moviesTotalFilter === '50' ? 'selected' : '' %>>At least 50</option>
              <option value="100" <%= moviesTotalFilter === '100' ? 'selected' : '' %>>At least 100</option>
            </select>
            <input type="hidden" name="page" value="<%= currentPage %>">
            <input type="hidden" name="sortField" value="<%= sortField %>">
            <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
            <input type="hidden" name="gender" value="<%= genderFilter %>">
            <input type="hidden" name="revenue" value="<%= revenueFilter %>">
            <input type="hidden" name="popularity" value="<%= popularityFilter %>">
            <input type="hidden" name="top5billing" value="<%= top5billingFilter %>">
            <input type="hidden" name="topLanguage" value="<%= topLanguageFilter %>">
          </form>
        </th>

        <th><a href="?sortField=cnt_all&sortOrder=<%= sortField === 'cnt_all' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Directed by Women</a></th>



        <th><a href="?sortField=directedByWomenPercentage&sortOrder=<%= sortField === 'directedByWomenPercentage' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Directed by Women Percentage</a></th>

        <!-- New Top 5 Billing Column with Filter -->
        <th><a href="?sortField=top5billing&sortOrder=<%= sortField === 'top5billing' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Top 5 Billing</a><br/>
          <!-- Top 5 Billing Filter Dropdown -->
          <form method="GET" action="/all" style="display: inline-block;">
            <select id="top5billing-filter" name="top5billing" onchange="this.form.submit()">
              <option value="all" <%= top5billingFilter === 'all' ? 'selected' : '' %>>All</option>
              <option value="5" <%= top5billingFilter === '5' ? 'selected' : '' %>>At least 5</option>
              <option value="10" <%= top5billingFilter === '10' ? 'selected' : '' %>>At least 10</option>
              <option value="20" <%= top5billingFilter === '20' ? 'selected' : '' %>>At least 20</option>
            </select>
            <input type="hidden" name="page" value="<%= currentPage %>">
            <input type="hidden" name="sortField" value="<%= sortField %>">
            <input type="hidden" name="sortOrder" value="<%= sortOrder %>">
            <input type="hidden" name="gender" value="<%= genderFilter %>">
            <input type="hidden" name="revenue" value="<%= revenueFilter %>">
            <input type="hidden" name="popularity" value="<%= popularityFilter %>">
            <input type="hidden" name="moviesTotal" value="<%= moviesTotalFilter %>">
            <input type="hidden" name="topLanguage" value="<%= topLanguageFilter %>">
          </form>
        </th>

        


        <th><a href="?sortField=updated&sortOrder=<%= sortField === 'updated' && sortOrder === 'asc' ? 'desc' : 'asc' %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>">Updated</a></th>

      </tr>
    </thead>
    <tbody>
      <% actors.forEach(actor => { %>
        <tr>
          <td><a href="/actor/<%= actor.id %>"><%= actor.name %></a></td>
          <td><%= actor.id %></td>
          <td><%= actor.gender === 2 ? 'Male' : actor.gender === 1 ? 'Female' : 'Non-Binary' %></td>
          <td><%= actor.topLanguage %></td>
          <td><%= actor.popularity %></td>
          <td>
            <% 
              if (actor.revenue) {
      const formattedRevenue = actor.revenue >= 1_000_000_000 
        ? (actor.revenue / 1_000_000_000).toFixed(1) + ' billion' 
        : actor.revenue >= 1_000_000 
          ? (actor.revenue / 1_000_000).toFixed(0) + ' million' 
          : actor.revenue.toLocaleString();
  %>
    <%= formattedRevenue %>
            <% } else {actor.revenue } %>
          </td>
          <td><%= actor.movies_total %></td>
          <td><%= actor.cnt_all %></td>
          <td><%= (actor.directedByWomenPercentage * 100).toFixed(0) %>%</td>
          <td><%= actor.top5billing %></td>
          <td><%= actor.updated ? new Date(actor.updated).toLocaleString() : 'N/A' %></td>
        </tr>
      <% }); %>
    </tbody>
  </table>

  <!-- Pagination -->
  <div class="pagination">
    <% for (let i = 1; i <= Math.ceil(totalActors / limit); i++) { %>
      <a href="?page=<%= i %>&sortField=<%= sortField %>&sortOrder=<%= sortOrder %>&gender=<%= genderFilter %>&revenue=<%= revenueFilter %>&popularity=<%= popularityFilter %>&moviesTotal=<%= moviesTotalFilter %>&top5billing=<%= top5billingFilter %>&topLanguage=<%= topLanguageFilter %>" 
         class="<%= currentPage === i ? 'active' : '' %>"><%= i %></a>
    <% } %>
  </div>


  <footer>
    <div>
      <a href="about.html">About this page</a>, &copy; 2024
    </div>

    <div>
      Powered by :  <a href="https://www.themoviedb.org/"><img src="/blue_short-tmdb.svg" alt="TMDB Logo" style="width: 150px;"></a>
    </div>

    <div>
      <a href='https://ko-fi.com/W7W41KRRZ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi3.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a>
    </div>
  </footer>
</body>
</html>
